<!DOCTYPE html>
<html>
<head>
    <title>Google Maps Markers</title>
    <style>
        #map {
            height: 400px;
            width: 100%;
        }
        #side-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 300px;
            height: 400px;
            background-color: white;
            padding: 10px;
            border: 1px solid #ccc;
            display: none;
        }
        #side-panel.active {
            display: block;
        }
        iframe {
            width: 100%;
            height: 200px;
            border: none;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div id="side-panel">
        <iframe id="chart1" src=""></iframe>
        <iframe id="chart2" src=""></iframe>
        <iframe id="chart3" src=""></iframe>
        <iframe id="chart4" src=""></iframe>
    </div>
    <script>
        var map;
        var markers = [];

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 20.98757293313669, lng: 105.93685697450815 },
                zoom: 15
            });

            // Create markers
            var locations = [
                { lat: 20.98757293313669, lng: 105.93685697450815, status: true },
                { lat: 20.9885281986878, lng: 105.93641384324708, status: false },
                { lat: 20.989660048349222, lng: 105.936062074998, status: false },
                { lat: 20.990689732556987, lng: 105.9356772327678, status: false }
            ];

            for (var i = 0; i < locations.length; i++) {
                var marker = new google.maps.Marker({
                    position: locations[i],
                    map: map,
                    icon: locations[i].status ? 'http://maps.google.com/mapfiles/ms/icons/green-dot.png' : 'http://maps.google.com/mapfiles/ms/icons/yellow-dot.png'
                });

                // Add click event listener
                marker.addListener('click', function () {
                    handleMarkerClick(locations.indexOf(this.getPosition().toJSON()));
                });

                markers.push(marker);
            }
        }

        function handleMarkerClick(chartIndex) {
            var iframeSources = [
                'https://thingspeak.com/channels/2449920/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line',
                'https://thingspeak.com/channels/2449920/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15',
                'https://thingspeak.com/channels/2449920/charts/3?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15',
                'https://thingspeak.com/channels/2449920/charts/4?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15'
                        ];
                      
                    document.getElementById('side-panel').className = 'active';
                    document.getElementById('chart1').src = iframeSources[chartIndex - 1];
                    document.getElementById('chart2').src = iframeSources[(chartIndex % 4) + 1];
                    document.getElementById('chart3').src = iframeSources[(chartIndex % 4) + 2];
                    document.getElementById('chart4').src = iframeSources[(chartIndex % 4) + 3];
                    };
                
        
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDl1KFan0b8-CUfVZn1q87FDQNAT61fRKc&callback=initMap">
    </script>
</body>
</html>

<!--

<!DOCTYPE html>
<html>
<head>
    <title>Google Maps Markers</title>
    <style>
        #map {
            height: 500px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <script>
        var map;
        var markers = [];
        var data;

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 20.98757293313669, lng: 105.93685697450815 },
                zoom: 15
            });

            // Fetch data from Google Sheets
            fetch('https://sheets.googleapis.com/v4/spreadsheets/1-rQXU0t33ILZb3maYWHjexXdAcKLVph0ljoGLspnmzQ/values/Sheet1!A1:D?key=')
                .then(response => response.json())
                .then(data => {
                    // Parse data and update markers
                    updateMarkers(data.values);
                });
        }

        function updateMarkers(values) {
            // Remove existing markers
            markers.forEach(marker => {
                marker.setMap(null);
            });
            markers = [];

            // Create new markers
            for (var i = 0; i < values.length; i++) {
                var location = { lat: parseFloat(values[i][0]), lng: parseFloat(values[i][1]) };
                var marker = new google.maps.Marker({
                    position: location,
                    map: map,
                    icon: getMarkerIcon(i)
                });

                // Add event listeners
                marker.addListener('dblclick', function () {
                    handleMarkerDoubleClick(i);
                });

                markers.push(marker);
            }
        }

        function getMarkerIcon(index) {
            var color = (data[index][2] > data[index][3]) ? 'green' : 'yellow';
            return {
                path: google.maps.SymbolPath.CIRCLE,
                scale: 8,
                fillColor: color,
                fillOpacity: 0.6,
                strokeColor: 'black',
                strokeWeight: 1
            };
        }

         // Create markers
        var locations = [
            { lat: 20.98757293313669, lng: 105.93685697450815 },
            { lat: 20.9885281986878, lng: 105.93641384324708 },
            { lat: 20.989660048349222, lng: 105.936062074998 },
            { lat: 20.990689732556987, lng: 105.9356772327678 }
        ];

        for (var i = 0; i < locations.length; i++) {
        var marker = new google.maps.Marker({
            position: locations[i],
            map: map
        });

        // Add click event listener
        marker.addListener('click', function() {
            var iframeContent = `<iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/2449920/charts/${this.getPosition().toString().split('(')[1].split(')')[0]}?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15"></iframe>`;
            var infoWindow = new google.maps.InfoWindow();
            infoWindow.setContent(iframeContent);
            infoWindow.open(map, this);
        });
    }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDl1KFan0b8-CUfVZn1q87FDQNAT61fRKc&callback=initMap">
    </script>
</body>
</html>
-->